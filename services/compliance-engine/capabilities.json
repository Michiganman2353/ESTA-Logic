{
  "$schema": "https://esta-logic.dev/schemas/v1/capability-manifest.json",
  "service_id": "compliance-engine",
  "version": "1.0.0",
  "kernel_boundary_integration": {
    "module": "@esta/kernel-boundary",
    "capability_validator": "libs/kernel-boundary/src/capability.ts",
    "ruleset_source": "libs/accrual-engine/src/esta2025-ruleset.json"
  },
  "capabilities": [
    {
      "id": "db:read:compliance",
      "resource_type": "database",
      "rights": ["read", "list"],
      "description": "Read compliance data",
      "scope": ["compliance_records", "policy_records"],
      "delegatable": false
    },
    {
      "id": "db:write:compliance",
      "resource_type": "database",
      "rights": ["write", "create"],
      "description": "Write compliance results",
      "scope": ["compliance_records"],
      "delegatable": false
    },
    {
      "id": "rules:evaluate:all",
      "resource_type": "wasm_module",
      "rights": ["execute"],
      "description": "Evaluate compliance rules via ruleset engine",
      "scope": ["esta2025_ruleset", "michigan_rules"],
      "delegatable": false
    },
    {
      "id": "audit:write:log",
      "resource_type": "audit_log",
      "rights": ["write", "create"],
      "description": "Write audit log entries for compliance checks",
      "scope": ["audit_log"],
      "delegatable": false
    },
    {
      "id": "messaging:send:ipc",
      "resource_type": "channel",
      "rights": ["write"],
      "description": "Send compliance results",
      "scope": ["ui-sync-service", "employer-engine"],
      "delegatable": true
    },
    {
      "id": "messaging:receive:ipc",
      "resource_type": "channel",
      "rights": ["read"],
      "description": "Receive evaluation requests",
      "scope": ["accrual-engine", "employer-engine"],
      "delegatable": false
    }
  ]
}
